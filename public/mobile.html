<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å±€åŸŸç½‘å¿«ä¼  - ç§»åŠ¨ç«¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <style>
        :root {
            --primary: #3b82f6;
            --bg: #0f172a;
        }
        body {
            background-color: var(--bg);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", sans-serif;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        .glass-morphism {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .active-glow {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
        }
        /* ç§»åŠ¨ç«¯é›·è¾¾åŠ¨ç”» */
        .radar-wave {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            animation: wave 3s infinite linear;
        }
        @keyframes wave {
            0% { width: 80px; height: 80px; opacity: 1; }
            100% { width: 300px; height: 300px; opacity: 0; }
        }
        .wave-delay-1 { animation-delay: 1s; }
        .wave-delay-2 { animation-delay: 2s; }

        .action-sheet {
            border-radius: 2rem 2rem 0 0;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="p-5 flex justify-between items-center z-20">
        <div class="flex flex-col">
            <h1 class="text-xl font-bold tracking-tight">å±€åŸŸç½‘å¿«ä¼ </h1>
            <span class="text-[10px] font-mono text-blue-400 font-semibold uppercase tracking-wider">chuanwenjian.com</span>
        </div>
        <div class="flex items-center gap-3">
            <div class="bg-green-500/10 border border-green-500/20 px-3 py-1 rounded-full flex items-center gap-1.5">
                <span id="connection-indicator" class="w-1.5 h-1.5 bg-green-500 rounded-full"></span>
                <span id="connection-status" class="text-[10px] text-green-400 font-bold uppercase">Online</span>
            </div>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <main class="flex-grow flex flex-col px-5 relative overflow-hidden">
        
        <!-- èƒŒæ™¯é›·è¾¾è£…é¥° -->
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-0 opacity-50">
            <div class="radar-wave"></div>
            <div class="radar-wave wave-delay-1"></div>
            <div class="radar-wave wave-delay-2"></div>
        </div>

        <!-- å½“å‰ç”¨æˆ·çŠ¶æ€ -->
        <div class="relative z-10 flex flex-col items-center mt-6 mb-10">
            <div class="relative">
                <div class="w-24 h-24 bg-blue-600 rounded-3xl flex items-center justify-center text-4xl shadow-2xl rotate-3">
                    ğŸ¬
                </div>
                <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center border-4 border-slate-900">
                    <i class="fas fa-check text-[10px] text-white"></i>
                </div>
            </div>
            <h2 id="my-name" class="mt-4 text-xl font-bold">å¯çˆ±çš„æµ·è±š</h2>
            <p class="text-slate-400 text-xs mt-1">IP: <span id="network-id">æ­£åœ¨è·å–...</span></p>
        </div>

        <!-- è®¾å¤‡åˆ—è¡¨åŒºåŸŸ -->
        <div class="relative z-10 flex-grow">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-sm font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2">
                    <i class="fas fa-bullseye text-blue-500"></i> é™„è¿‘çš„è®¾å¤‡
                </h3>
                <span class="text-[10px] text-slate-500 italic">æ­£åœ¨æ‰«æ...</span>
            </div>

            <!-- è®¾å¤‡æ»šåŠ¨åˆ—è¡¨ -->
            <div id="peers-container" class="space-y-3 pb-32">
                <!-- åˆ—è¡¨å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
                <div class="border-2 border-dashed border-white/5 rounded-2xl p-6 flex flex-col items-center justify-center text-slate-600">
                    <div class="inline-block animate-spin rounded-full h-4 w-4 border-2 border-blue-500 border-t-transparent mb-2"></div>
                    <p class="text-[10px]">ç­‰å¾…å…¶ä»–è®¾å¤‡åŠ å…¥å±€åŸŸç½‘</p>
                </div>
            </div>
        </div>
    </main>

    <!-- åº•éƒ¨å›ºå®šåŠ¨ä½œåŒº -->
    <div class="fixed bottom-0 left-0 right-0 z-30 action-sheet glass-morphism px-6 pt-6 pb-8 safe-area-bottom">
        <div class="flex flex-col gap-4">
            
            <!-- æ¸©é¦¨æé†’ -->
            <div class="bg-blue-500/5 border border-blue-500/10 rounded-xl p-3">
                <p class="text-[10px] text-blue-300 text-center leading-relaxed">
                    <i class="fas fa-info-circle mr-1"></i>
                    æç¤ºï¼šéœ€ç¡®ä¿è®¾å¤‡è¿æ¥åœ¨ <span class="text-white font-bold">åŒä¸€ä¸ªè·¯ç”±å™¨/WiFi</span> ä¸‹
                </p>
                <p class="text-[10px] text-slate-500 text-center mt-2">ç‚¹å‡»è®¾å¤‡å‘é€æ–‡ä»¶ï¼Œç‚¹å‡» <i class="fas fa-comment-dots text-blue-400"></i> å‘é€æ¶ˆæ¯</p>
            </div>
            
            <!-- å­˜å‚¨è·¯å¾„æç¤º -->
            <div class="flex justify-center">
                <p class="text-[10px] text-slate-500">ä¿å­˜è·¯å¾„: <span class="text-slate-400">ç³»ç»Ÿç›¸å†Œ / ä¸‹è½½æ–‡ä»¶å¤¹</span></p>
                
                <!-- è‡ªåŠ¨ä¿å­˜è·¯å¾„ (éšè—æˆ–ç®€åŒ–æ˜¾ç¤º) -->
                <div class="hidden flex items-center gap-3">
                     <span class="text-xs text-amber-200/70 truncate w-32" id="download-dir-text"></span>
                     <button class="text-[10px] font-bold text-amber-500 hover:text-amber-400" id="download-dir-btn">ä¿®æ”¹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden file input -->
    <input type="file" id="file-input" style="display: none;" multiple>

    <!-- Dialogs -->
    <div id="receive-dialog" class="dialog hidden">
        <div class="dialog-content">
            <h3>æ–‡ä»¶ä¼ è¾“è¯·æ±‚</h3>
            <p><span id="sender-name">æœªçŸ¥ç”¨æˆ·</span> æƒ³è¦å‘é€ç»™ä½ :</p>
            <p id="file-name" class="file-name">example.txt</p>
            <p id="file-size" class="file-size">1.2 MB</p>
            <div class="dialog-actions">
                <button id="btn-reject" class="btn secondary">æ‹’ç»</button>
                <button id="btn-accept" class="btn primary">æ¥æ”¶</button>
            </div>
        </div>
    </div>

    <div id="progress-dialog" class="dialog hidden">
        <div class="dialog-content">
            <h3 id="transfer-status">ä¼ è¾“ä¸­...</h3>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
            </div>
            <p id="progress-text">0%</p>
        </div>
    </div>

    <!-- Text Chat Dialogs -->
    <div id="send-text-dialog" class="dialog hidden">
        <div class="dialog-content">
            <h3>å‘é€æ¶ˆæ¯</h3>
            <textarea id="text-input" placeholder="åœ¨æ­¤è¾“å…¥æ¶ˆæ¯..." rows="5" style="width: 100%; margin: 10px 0; padding: 8px; box-sizing: border-box; resize: vertical; background: #334155; color: white; border: 1px solid #475569; border-radius: 8px;"></textarea>
            <div class="dialog-actions">
                <button id="btn-cancel-text" class="btn secondary">å–æ¶ˆ</button>
                <button id="btn-send-text" class="btn primary">å‘é€</button>
            </div>
        </div>
    </div>

    <div id="receive-text-dialog" class="dialog hidden">
        <div class="dialog-content">
            <h3>æ”¶åˆ°æ¶ˆæ¯</h3>
            <p>æ¥è‡ª <span id="text-sender-name">æœªçŸ¥ç”¨æˆ·</span>:</p>
            <div id="text-content" style="background: #334155; padding: 15px; border-radius: 8px; text-align: left; margin: 10px 0; white-space: pre-wrap; max-height: 200px; overflow-y: auto; color: white;"></div>
            <div class="dialog-actions">
                <button id="btn-close-text" class="btn primary">å…³é—­</button>
                <button id="btn-copy-text" class="btn secondary">å¤åˆ¶</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>